\documentclass[11pt,a4paper,parskip=half, abstraction]{scrartcl}
\usepackage{isabelle,isabellesym}

% further packages required for unusual symbols (see also
% isabellesym.sty), use only when needed

%\usepackage{amssymb}
  %for \<leadsto>, \<box>, \<diamond>, \<sqsupset>, \<mho>, \<Join>,
  %\<lhd>, \<lesssim>, \<greatersim>, \<lessapprox>, \<greaterapprox>,
  %\<triangleq>, \<yen>, \<lozenge>

%\usepackage[greek,english]{babel}
  %option greek for \<euro>
  %option english (default language) for \<guillemotleft>, \<guillemotright>

\usepackage[only,bigsqcap]{stmaryrd}
  %for \<Sqinter>

%\usepackage{eufrak}
  %for \<AA> ... \<ZZ>, \<aa> ... \<zz> (also included in amssymb)

%\usepackagetcomp}
  %for \<onequarter>, \<onehalf>, \<threequarters>, \<degree>, \<cent>,
  %\<currency>

% this should be the last package used
\usepackage{pdfsetup}

% urls in roman style, theoryt in math-similar italics
\urlstyle{rm}
\isabellestyle{it}

% for uniform font size
%\renewcommand{\isastyle}{\isastyleminor}

% From src/HOL/HOLCF/document/root
\newcommand{\isasymnotsqsubseteq}{\isamath{\not\sqsubseteq}}


\begin{document}

\title{The Correctness of Launchbury's Natural Semantics for Lazy Evaluation}
\author{Joachim Breitner}
\maketitle

\begin{abstract}
In his seminal paper „Natural Semantics for Lazy Evaluation“ \cite{launchbury},
John Launchbury proves his semantics correct with respect to a denotational
semantics. We have formalized both semantics and identified an ambiguity in
what the $\sqcup$ operator should do: If it is understood as the least upper
bound, as hinted at in the paper, the original proof fails.  We fix the proof
by taking a detour via a modified natural semantics with an explicit stack. In
addition, we show that the original proof goes through when $\sqcup$ is
understood to be a right-sided update.
\end{abstract}

\tableofcontents

\section{Introduction}

TODO
\subsection{Theory overview}

Chapter \ref{ch_aux} contains auxillary theories, not necessarily tied to Launchbury's semantics. The base theories are kept independent of Nominal and HOLCF where possible, the lemmas combining them are in theories of their own, creatively named by appending \isar{-Nominal}, \isar{-HOLCF} or both.  You will find the section:
\begin{itemize}
\item General utility functions extending HOLCF resp.\ Nominal (\isa{Nominal-Utils}, \isa{HOLCF-Utils}).
\item A theory combining notions from HOLCF and Nominal, e.g. continutiy of permutation (\isa{Nominal-Utils}).
\item A notion of distinctly named associative lists (\isa{DistinctVars}). 
\item A generalisation of some parts of HOLCF to work on a set as a carrier instead of a type (\isa{HOLCF-Set}).
\item Binary joins in the context of HOLCF (\isa{HOLCF-Join}).
\item A notion of down-closed sets in the context of HOLCF (\isa{HOLCF-Down-Closed}).
\item A theory of fixed points of binary joins (\isa{HOLCF-Fix-Join}).
\item A type for finite maps with a chain-complete partial order (\isa{FMap}, \isa{FMap-Nominal}, \isa{FMap-HOLCF}, \isa{FMap-Nominal-HOLCF}).
\end{itemize}

Chapter \ref{ch_natsem} defines Launchbury's natural semantics, while \ref{ch_natsemstack} provides a variant with an explicit stack and proves them equivalent.

Chapter \ref{ch_dendom} sets the stage for the denotational semantics by defining the denotational domain, proving that binary meets exist.

Chapter \ref{ch_denjoin} defines the denotational semantics where $\sqcup$ means the least upper bound. We show that Launchbury's Theorem 2 as stated is false for this semantics, and provide an alternative proof, that avoids the problematic generalisation, via the stacked semantics. The theory HSem is abstract in the concrete denotation of expressions.

Chapter \ref{ch_denupd} defines the denotational semantics where $\sqcup$ means right-sided update, and proves Launchbury's semantics correct using the proof from his paper. Again, the theory \isa{HSem} is abstract in the dconcrete enotation of expressions.

\newcommand{\theory}[1]{\subsection{#1}\label{sec_#1}\input{#1.tex}}

\clearpage
\section{Auxillary theories}
\label{ch_aux}

\theory{Nominal-Utils}

\theory{HOLCF-Utils}

\theory{Nominal-HOLCF}

\theory{DistinctVars}

\theory{HOLCF-Set}

\theory{HOLCF-Join}

\theory{HOLCF-Down-Closed}

\theory{HOLCF-Fix-Join}

\theory{FMap}

\theory{FMap-Nominal}

\theory{FMap-HOLCF}

\theory{FMap-Nominal-HOLCF}


\clearpage
\section{Launchbury's natural semantics}
\label{ch_natsem}

\theory{Terms}
\theory{Heap}

\theory{Launchbury}

\clearpage
\section{Stackful natural semantics}
\label{ch_natsemstack}

\theory{LaunchburyStacked}

\theory{LaunchburyMoreFree}

\theory{Launchbury-Unstack}

\section{Denotational domain}
\label{ch_dendom}

\theory{Denotational-Common}

\theory{Value-Meet}

\theory{HeapToEnv}

\clearpage
\section{Denotational semantics with join}
\label{ch_denjoin}

\theory{HSem}

\theory{Denotational}

\theory{Denotational-Props}

\theory{Correctness-Counterexample}

\theory{CorrectnessStacked}

\theory{Correctness}

\clearpage
\section{Denotational semantics with update}
\label{ch_denupd}

\theory{HSemUpd}

\theory{DenotationalUpd}

\theory{Denotational-PropsUpd}

\theory{CorrectnessUpd}

\clearpage
\section{Conclusion}

TODO

\clearpage
\bibliographystyle{abbrv}
\bibliography{root}

\end{document}
